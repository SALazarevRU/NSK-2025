<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <!-- Фавикон -->
   <link rel="icon" type="image/png" sizes="192x192" href="/NSK-2025/favicon-192.png">
   <link rel="icon" type="image/png" sizes="16x16" href="/NSK-2025/favicon-16.png">
   <link rel="icon" type="image/png" sizes="32x32" href="/NSK-2025/favicon-32.png">
   <link rel="icon" type="image/x-icon" href="/NSK-2025/favicon.ico">
   
    <title>Просмотр XML кода кастомной панели</title>
    
    <!-- Подключение внешнего CSS-файла -->
    <link href="pokazatescho.css" rel="stylesheet">
    
    <!-- Подключение jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>  
    
    
     
    
     <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 1300px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
        }
        #text-container {
            border: 1px solid #ccc;
            padding: 15px;
            min-height: 800px;
            overflow-y: auto;
            background-color: #f9f9f9;
            border-radius: 5px;
            
            /* Ключевое правило для сохранения форматирования */
            white-space: pre-line; /* сохраняет переносы строк */
            font-family: monospace; /* моноширинный шрифт как в редакторе */
        }
        .loading {
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
	

<div class="content-block-fix">
        <div class="content-block-text">
        <h3>Программа для работы с Ribbon итерфейсом</h3>
            <p>Основные возможности RibbonXMLEditor:

Быстрое построение xml-описания интерфейса ленты (ribbon), закулисья (backstage), команд (command), контекстных меню (contextMenus) и панели быстрого доступа (qat) путём нажатия на кнопки, соответствующие различным элементам интерфейса или путём вставки этих элементов из списка контекстно-чувствительного автодополнения.
Импорт внешних изображений для значков элементов интерфейса.
Внедрение интерфейса в документы Word, Excel, PowerPoint или Access.
Импорт/экспорт xml-макета интерфейса в файл настроек ленты, поддерживаемый офисом начиная с 2010-й версии.
Генерация на основе построенного xml-кода модуля ".bas" для VBA с шаблонами процедур обратного вызова и внедрение его в документ.
Редактор имеет много полезных функций, таких как:

Контекстно-чувствительное автодополнение
Всплывающие подсказки по коду
Встроенная галерея офисных иконок, содержащая несколько тысяч изображений
Автоформатирование кода
Валидация кода
Запуск документа в родном приложении не выходя из редактора с возможностью выбора версии офиса, если у вас установлено несколько версий одновременно.
Система поиска, в том числе с помощью регулярных выражений
Система быстрого поиска по идентификатору
Фолдинг (сворачивание содержимого тегов)
Удобство работы с редактором обеспечивается следующими свойствами редактора:

Подсветка синтаксиса
Подсветка парных тегов и текущей строки
Возможность быстрого перехода к началу и к концу ближайшего тега (Ctrl+< и Ctrl+>)
Мощная система настраиваемых стилей подсветки кода
Откат и отмена отката
Встраивание пункта «Открыть в Ribbon XML Editor» в контекстное меню проводника операционной системы
Запоминание списка последних документов и возможность автоматически открывать последний
Доступ к связанным с интерфейсом структурам документа (файлу корневых ссылок, файлу ссылок на изображения, файлу типов файлов)
Информативные всплывающие подсказки кнопок элементов с указанием дочерних элементов
Справка со схемами иерархии корневых элементов commands, ribbon, backstage и contextMenus, списками идентификаторов вкладок и групп и описанием приёмов работы с программой</p>
        </div>
        <div class="show-all-container">
            <button class="show-all">Показать полностью</button>    
        </div>
    </div>  
    
    

    <div class="container">
        <h1>XML код Надстройки</h1>
        <div id="text-container" class="loading">Загружается...</div>
    </div>  
        
    <script>
        $(".content-block-text").each(function() {
            let th = $(this);
            if (th.prop('scrollHeight') > th.height()) {
                let more = th.next(".show-all-container").find(".show-all");    
                th.next(".show-all-container").show();    
                th.addClass("content-block-text-shadow");
                more.click(function() {
                    th.toggleClass("content-block-text-shadow content-block-text-open");
                    more.text(more.text() == "Скрыть" ? "Показать полностью" : "Скрыть");
                });
            }
        });   

        // Функция для загрузки текста из файла
        async function loadTextFromFile() {
            try {
                const response = await fetch('primer.txt');
                
                if (!response.ok) {
                    throw new Error(`Ошибка загрузки: ${response.status}`);
                }
                
                const text = await response.text();
                document.getElementById('text-container').textContent = text;
            } catch (error) {
                document.getElementById('text-container').innerHTML = 
                    `<p style="color: red;">Ошибка: ${error.message}</p>`;
            }
        }

        window.addEventListener('load', loadTextFromFile);
    </script>
    
   
    
</body>
</html>